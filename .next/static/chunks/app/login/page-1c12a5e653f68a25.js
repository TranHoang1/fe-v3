(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{2284:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var a=s(5155),r=s(2115),n=s(5695),o=s(4096);let i={baseUrl:s(9509).env.NEXT_PUBLIC_API_BASE_URL||"http://opsched.deltavn.vn:8014/luckydraw",timeout:3e4,defaultHeaders:{"Content-Type":"application/json",Accept:"*/*"}},c={auth:{login:"/api/auth/login",logout:"/api/auth/logout",refreshToken:"/api/auth/refresh-token"}},l=e=>{let t=i.baseUrl.endsWith("/")?i.baseUrl.slice(0,-1):i.baseUrl,s=e.startsWith("/")?e:"/".concat(e);return"".concat(t).concat(s)},d=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:s="GET",headers:a={},body:r=null,includeAuth:n=!0}=t,c=l(e),d={...i.defaultHeaders,...a};if(n){let e=(0,o.c4)();if(e)d.Authorization="Bearer ".concat(e);else{if(!window.location.pathname.includes("/login")){let e=window.location.pathname.replace(/^\/admin/,"");window.location.href="/login?redirectTo=".concat(encodeURIComponent(e))}throw Error("Authentication required")}}let u={method:s,headers:d,credentials:n?"include":"same-origin"};r&&"GET"!==s&&(u.body="object"==typeof r?JSON.stringify(r):r);try{let e=await fetch(c,u),t=await e.json();if(!e.ok)throw{status:e.status,message:t.message||"An error occurred",data:t};return t}catch(e){throw console.error("API request failed:",e),e}},u={get:(e,t)=>d(e,{...t,method:"GET"}),post:(e,t,s)=>d(e,{...s,method:"POST",body:t}),put:(e,t,s)=>d(e,{...s,method:"PUT",body:t}),patch:(e,t,s)=>d(e,{...s,method:"PATCH",body:t}),delete:(e,t)=>d(e,{...t,method:"DELETE"}),auth:{login:(e,t)=>u.post(c.auth.login,{username:e,password:t},{includeAuth:!1}),logout:()=>u.post(c.auth.logout,{})}};var h=s(2895);let m=(0,h.A)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),x=(0,h.A)("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);function g(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)(),[s,o]=(0,r.useState)(""),[i,c]=(0,r.useState)(""),[l,d]=(0,r.useState)(""),[h,g]=(0,r.useState)(!1),p=(null==t?void 0:t.get("redirectTo"))||"/",f=p.startsWith("/")&&!p.startsWith("/admin")?"/admin".concat(p):p,w=async t=>{if(t.preventDefault(),!h){d(""),g(!0);try{let t=await u.auth.login(s,i);t.data&&localStorage.setItem("token",t.data);let a=new Date;a.setHours(a.getHours()+24),localStorage.setItem("tokenExpires",a.toISOString()),e.push(f)}catch(e){d(e.message||"Invalid username or password"),console.error(e)}finally{g(!1)}}};return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-[#1e1e1e] p-4",children:(0,a.jsxs)("div",{className:"w-full max-w-md bg-[#252526] border border-[#3c3c3c] rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)("div",{className:"w-10 h-10 bg-[#007acc] rounded-md flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white font-bold text-xl",children:"LD"})})}),(0,a.jsx)("h2",{className:"text-2xl text-center text-white",children:"Login"}),(0,a.jsx)("p",{className:"text-center text-gray-400",children:"Enter your credentials to access the LuckyDraw system"})]}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[l&&(0,a.jsx)("div",{className:"bg-red-900/20 border border-red-800 text-red-100 px-4 py-2 rounded text-sm",children:l}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"username",className:"text-sm font-medium text-white",children:"Username"}),(0,a.jsx)("input",{id:"username",type:"text",value:s,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 bg-[#3c3c3c] border border-[#555555] rounded-md focus:outline-none focus:ring-2 focus:ring-[#007acc] text-white",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"password",className:"text-sm font-medium text-white",children:"Password"}),(0,a.jsx)("input",{id:"password",type:"password",value:i,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 bg-[#3c3c3c] border border-[#555555] rounded-md focus:outline-none focus:ring-2 focus:ring-[#007acc] text-white",required:!0})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("a",{href:"#",className:"text-sm text-[#007acc] hover:underline",children:"Forgot password?"})}),(0,a.jsx)("button",{type:"submit",className:"w-full flex items-center justify-center px-4 py-2 bg-[#007acc] hover:bg-[#0069ac] text-white rounded-md transition-colors ".concat(h?"opacity-70 cursor-not-allowed":""),disabled:h,children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m,{className:"mr-2 h-4 w-4 animate-spin"}),"Logging in..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x,{className:"mr-2 h-4 w-4"}),"Login"]})}),h&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50","aria-hidden":"true",children:(0,a.jsxs)("div",{className:"bg-[#252526] p-4 rounded-md flex items-center gap-3",children:[(0,a.jsx)(m,{className:"h-5 w-5 animate-spin text-[#007acc]"}),(0,a.jsx)("span",{children:"Processing..."})]})})]})})]})})}function p(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-[#1e1e1e] text-white",children:"Loading..."}),children:(0,a.jsx)(g,{})})}},2895:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var a=s(2115),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=(e,t)=>{let s=(0,a.forwardRef)((s,o)=>{let{color:i="currentColor",size:c=24,strokeWidth:l=2,absoluteStrokeWidth:d,children:u,...h}=s;return(0,a.createElement)("svg",{ref:o,...r,width:c,height:c,stroke:i,strokeWidth:d?24*Number(l)/Number(c):l,className:"lucide lucide-".concat(n(e)),...h},[...t.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...(Array.isArray(u)?u:[u])||[]])});return s.displayName="".concat(e),s}},4096:(e,t,s)=>{"use strict";s.d(t,{c4:()=>r,jL:()=>n,wR:()=>a});let a=()=>{if(!localStorage.getItem("token"))return!1;let e=localStorage.getItem("tokenExpires");return!e||new Date(e)>new Date},r=()=>localStorage.getItem("token"),n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.pathname;o(e)&&(sessionStorage.setItem("redirecting","true"),window.location.href="/admin/login/")},o=e=>!e.includes("/admin/login/")},5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},8065:(e,t,s)=>{Promise.resolve().then(s.bind(s,2284))}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(8065)),_N_E=e.O()}]);